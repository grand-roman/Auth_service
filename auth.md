#API для сайта и личного кабинета

регистрация пользователя;
вход пользователя в аккаунт (обмен логина и пароля на пару токенов: JWT-access токен и refresh токен);
обновление access-токена;
выход пользователя из аккаунта;
изменение логина или пароля (с отправкой email вы познакомитесь в следующих модулях, поэтому пока ваш сервис должен позволять изменять личные данные без дополнительных подтверждений);
получение пользователем своей истории входов в аккаунт;

##регистрация
POST /api/v1/user

login
password

Это должен быть запрос от анонимного пользователя
Создание записи в бд, если такой еще нет
Этот метод также сразу вернет токены (генерация токенов) TODO: Или тут должна быть какая то переадресация на login

Ошибки:
Существующий пользователь

##вход пользователя в аккаунт (обмен логина и пароля на пару токенов: JWT-access токен и refresh токен);
POST /api/v1/user/login

login
password

Проверяем логин и пароль
Сохраняем информацию о входе
Генерация токенов

Ошибки:
Пользователя не существует
Не верный пароль


##обновление access-токена;
POST /api/v1/token/refresh

TODO: ?

##выход пользователя из аккаунта;
POST /api/v1/user/logout

Проверка подписи
В целом проверка токена
Сохранение токена в redis?
Удаление cookie

Ошибки:
TODO:
Херовый токен
Не залогинен

##изменение логина или пароля
PATCH /api/v1/user/<id>

login
password

TODO:

##получение пользователем своей истории входов в аккаунт;
GET /api/v1/login/history
auth required

Ошибки:
Не прошел валидацию токен


#API для управления доступами

CRUD для управления ролями:
создание роли,
удаление роли,
изменение роли,
просмотр всех ролей.
назначить пользователю роль;
отобрать у пользователя роль;
метод для проверки наличия прав у пользователя.

TODO: кто может это делать?
##CRUD для управления ролями:
##создание роли,
POST /api/v1/role/
##удаление роли,
DELETE /api/v1/role/<id>
##изменение роли
TODO: put?

PUT /api/v1/role/<id>
##просмотр всех ролей.
GET /api/v1/role


admin, user, role_editor?
##назначить пользователю роль;
POST /api/v1/user/<user_id>/role/<role_id>
##отобрать у пользователя роль;
DELETE /api/v1/user/<user_id>/role/<role_id>
##метод для проверки наличия прав у пользователя.
GET /api/v1/user/<user_id>/role


## Подсказки

1. Продумайте, что делать с анонимными пользователями, которым доступно всё, что не запрещено отдельными правами.
В методах, которые требуют каких то ролей есть их проверка?
2. Метод проверки авторизации будет всегда нужен пользователям. Ходить каждый раз в БД — не очень хорошая идея. Подумайте, как улучшить производительность системы.
JWT
3. Добавьте консольную команду для создания суперпользователя, которому всегда разрешено делать все действия в системе.
4. Чтобы упростить себе жизнь с настройкой суперпользователя, продумайте, как сделать так, чтобы при авторизации ему всегда отдавался успех при всех запросах.
5. Для реализации ограничения по фильмам подумайте о присвоении им какой-либо метки. Это потребует небольшой доработки ETL-процесса.
